!function(){"use strict";function e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const t={_storage:new WeakMap,put:function(e,t,r){this._storage.has(e)||this._storage.set(e,new Map),this._storage.get(e).set(t,r)},get:function(e,t){return this._storage.get(e).get(t)},has:function(e,t){return this._storage.has(e)&&this._storage.get(e).has(t)},remove:function(e,t){var r=this._storage.get(e).delete(t);return 0===!this._storage.get(e).size&&this._storage.delete(e),r}},r=function(e,t,r,o){let a;a="object"==typeof e?[document]:Array.from(document.querySelectorAll(e));let n=t.split(" ");if("function"==typeof r){let e=r;a.forEach((function(t){n.forEach((function(r){t.addEventListener(r,(function(r){e(t,r)}))}))}))}else a.forEach((function(e){n.forEach((function(t){e.addEventListener(t,(function(e){e.target.matches(r)&&o(e.target,e)}))}))}))},o=function(e,t,r,o){t.split(" ").forEach((function(t){document.querySelector(e).addEventListener(t,(function(e){r(e.target,e,o)}))}))},a=function(e,t="block"){Array.from(document.querySelectorAll(e)).forEach((function(e){e.style.display=t}))},n=function(e){Array.from(document.querySelectorAll(e)).forEach((function(e){e.style.display="none"}))},i=function(e,t){let r;"object"==typeof e?e instanceof Element?r=[e]:e instanceof NodeList&&(r=Array.from(e)):r=Array.from(document.querySelectorAll(e)),r.forEach((function(e){e.classList.add(t)}))},l=function(e,t){let r;"object"==typeof e?e instanceof Element?r=[e]:e instanceof NodeList&&(r=Array.from(e)):r=Array.from(document.querySelectorAll(e)),r.forEach((function(e){e.classList.remove(t)}))},c=function(e,t){return"object"!=typeof e&&(e=document.querySelector(e)),e.classList.contains(t)};class s{constructor(){e(this,"mandatories",[]),e(this,"optionals",[]),e(this,"throwErrors",!0)}process(){let e=!1,r="",o=[],a=this.mandatories,n=this.optionals,i=this.throwErrors;if(a.length&&(o=Array.from(document.querySelectorAll(a)),o.forEach((function(t,o){if(t){let o=t.value;null==o&&(o=""),""==o.trim()&&(t.closest(".js_parent").querySelector(".this_element_name").classList.add("red_error"),t.classList.add("red_error"),e=!0,r+='<p>Je třeba vyplnit "'+t.closest(".js_parent").querySelector(".this_element_name").textContent+'"</p>')}})),e)){if(i){let e=document.querySelector(".general_error");e.querySelector(".error_is").innerHTML=r,e.style.display="block",TweenMax.to([document.documentElement,document.body],1,{scrollTop:d(document.querySelector(".red_error")).top})}return!1}n.length&&(o=o.concat(Array.from(document.querySelectorAll(n))));let l=new FormData;return o.forEach((function(e,r){if(e){let r=e.id,o=0;if(t.has(e,"Datepick")){let r=new Date(t.get(e,"Datepick").getDate("mm/dd/yyyy"));e.classList.contains("from")?(r.setHours(0,0,0,0),o=Math.ceil(r.getTime()/1e3)):e.classList.contains("to")?(r.setHours(23,59,59,999),o=Math.floor(r.getTime()/1e3)):(r.setHours(0,0,0,0),o=Math.ceil(r.getTime()/1e3))}else o=e.matches('[type="checkbox"]')?Number(e.checked):e.value.trim();l.append(r,o)}})),l}}const d=function(e){const t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset-document.documentElement.clientTop,left:t.left+window.pageXOffset-document.documentElement.clientLeft}};Date;const u=function(e,t){e.forEach((function(e,r){Array.from(document.querySelectorAll(r)).forEach((function(r,o){t.title=e,new Tooltip(r,t)}))}))};class _{constructor(e){return this.formData=new FormData,this.createFormData=function(e,t=""){for(let r in e){let o=e[r],a=t?t+"["+r+"]":r;"string"==typeof o||"number"==typeof o?this.formData.append(a,o):"object"==typeof o&&this.createFormData(o,a)}},this.createFormData(e),this.formData}}function m(e,t){let r=new _(e);fetch(t,{method:"POST",body:r,cache:"no-cache"}).then((e=>{if(!e.ok)throw new Error("Network response error");return e.json()})).then((e=>{show_success.play(0),n(".load_overlay")})).catch((function(e){console.log(e)}))}document.addEventListener("DOMContentLoaded",(function(e){if("undefined"!=typeof pagetype&&"cars index"==pagetype){const e={placement:"top",html:!0,delay:{show:700,hide:0},offset:"0, 1"},t=new Map([[".inliner.status","Skryje/zobrazí<br>vozidlo na webu"],[".inliner.edit","Úprava vozidla"],[".inliner.delete","Trvale smaže toto vozidlo"],[".inliner.move","Tažením seřadíte vozidla pro<br>pořadí zobrazení na webu"],[".inliner.active_language","Aktuální jazyk úprav"],[".inliner.edit_translation","Upravit překlad vozidla"],[".inliner.add_translation","Přidat překlad vozidla"]]);function o(){a(".load_overlay");let e={};Array.from(document.querySelectorAll(".records_table tr")).forEach((function(t,r){e[t.dataset.id]=r})),m(e,position_ajax_url)}u(t,e),Array.from(document.querySelectorAll(".records_table tr")).forEach((function(e,t){e.style.width=e.offsetWidth+"px"})),new Sortable(document.querySelector(".records_table tbody"),{animation:150,fallbackOnBody:!1,forceFallback:!0,handle:".inliner.move",swapThreshold:1.5,onUpdate:o,direction:"vertical"}),r(".inliner.status","click",(function(e){let t="";c(e,"inactive")?(l(e,"inactive"),t="active"):(i(e,"inactive"),t="draft");let r={};r.language=e.dataset.language,r.language_id=e.dataset.languageIid,r.status=t,m(r,status_ajax_url)}))}if(r(".inliner.delete","click",(function(e){document.querySelector(".car_deletion").querySelector(".deletion_id").value=e.dataset.id,a(".car_deletion")})),r(".car_deletion .deletion_cancel","click",(function(){document.querySelector(".car_deletion").querySelector(".deletion_id").value="",n(".car_deletion")})),r(".car_deletion .deletion_confirm","click",(function(){n(".car_deletion");let e=document.querySelector(".car_deletion .deletion_id").value;document.querySelector(".records_table").querySelector('tr[data-id="'+e+'"]').remove();let t={};t.car_id=e,a(".load_overlay"),m(t,delete_ajax_url)})),"undefined"!=typeof pagetype&&("cars new"==pagetype||"cars edit"==pagetype)){const e={placement:"top",html:!0,delay:{show:1200,hide:0},offset:"0, 1"},m=new Map([[".mileage_lower_limit","Při nájezdu menším než tato hodnota zůstává cena bez slevy za kilometry"],[".mileage_upper_limit","Při nájezdu větším než tato hodnota již sleva neklesá"],[".mileage_max_discount","Sleva s rostoucími kilometry stále roste.<br>Zde zadejte jaká může být nejvyšší dosažitelná sleva"],[".mileage_coefficient","Vyšší číslo = sleva rychleji roste blízko spodního limitu kilometrů a více zpomaluje blízko horního limitu kilometrů.<br>Můžete zadat desetinné číslo"],[".days_lower_limit","Při pronájmu kratším než tato hodnota zůstává cena bez slevy za dny"],[".days_upper_limit","Při pronájmu delším než tato hodnota již sleva neklesá"],[".days_max_discount","Sleva s rostoucími dny stále roste.<br>Zde zadejte jaká může být nejvyšší dosažitelná sleva"],[".days_coefficient","Vyšší číslo = sleva rychleji roste blízko spodního limitu dnů a více zpomaluje blízko horního limitu dnů.<br>Můžete zadat desetinné číslo."]]);var d,_;if(u(m,e),Array.from(document.querySelectorAll(".only_digits")).forEach((e=>{IMask(e,{mask:Number,scale:0,signed:!1,thousandsSeparator:""})})),Array.from(document.querySelectorAll(".only_decimal_min")).forEach((e=>{IMask(e,{mask:Number,scale:2,signed:!1,thousandsSeparator:"",radix:".",mapToRadix:[","],min:0})})),init_text_editor("#language_description","undo redo | bold italic underline strikethrough subscript superscript removeformat numlist bullist"),Array.from(document.querySelectorAll(".select_type")).forEach((e=>{let r=e.id,o=new vanillaSelectBox("#"+r,{maxSelect:1});o.disableItems([""]),t.put(e,"vanillaSelectBox",o)})),autosize(document.querySelectorAll(".auto_resize")),is_primary_language&&document.querySelector("#chart_container_mileage")){let e=["1","2","3","4","5","6","7","8","9","10"],t=[0,0,0,0,0,0,0,0,0,0];(d=Highcharts.chart("chart_container_mileage",{chart:{type:"spline",styledMode:!0},title:{text:"Průběh ceny s rostoucími kilometry"},xAxis:{title:{text:"Kilometry"},categories:[]},legend:{enabled:!1},credits:{enabled:!1},yAxis:{title:{text:"Cena za km (Kč)"}},plotOptions:{spline:{dataLabels:{enabled:!0,formatter:function(){return Highcharts.numberFormat(this.y,2,",")}},enableMouseTracking:!1}},series:[{data:[]}]})).xAxis[0].setCategories(e),d.series[0].setData(t)}if(r(".discount_mileage_test","click",(function(){let e=new s;e.mandatories=["#standard_price","#mileage_lower_limit","#mileage_upper_limit","#mileage_max_discount","#mileage_coefficient"];let t=e.process();!1!==t&&(a(".load_overlay"),fetch(mileage_discount_test_ajax_url,{method:"POST",body:t,cache:"no-cache"}).then((e=>{if(!e.ok)throw new Error("Network response error");return e.json()})).then((e=>{d.xAxis[0].setCategories(e[0]),d.series[0].setData(e[1]),n(".load_overlay")})).catch((function(e){console.log(e)})))})),is_primary_language&&document.querySelector("#chart_container_days")){let e=["1","2","3","4","5","6","7","8","9","10"],t=[0,0,0,0,0,0,0,0,0,0];(_=Highcharts.chart("chart_container_days",{chart:{type:"spline",styledMode:!0},title:{text:"Průběh ceny s rostoucími dny"},xAxis:{title:{text:"Dny"},categories:[]},legend:{enabled:!1},credits:{enabled:!1},yAxis:{title:{text:"Cena za den (Kč)"}},plotOptions:{spline:{dataLabels:{enabled:!0,formatter:function(){return Highcharts.numberFormat(this.y,0,",")}},enableMouseTracking:!1}},series:[{data:[]}]})).xAxis[0].setCategories(e),_.series[0].setData(t)}r(".discount_days_test","click",(function(){let e=new s;e.mandatories=["#standard_price","#days_lower_limit","#days_upper_limit","#days_max_discount","#days_coefficient"];let t=e.process();!1!==t&&(a(".load_overlay"),fetch(days_discount_test_ajax_url,{method:"POST",body:t,cache:"no-cache"}).then((e=>{if(!e.ok)throw new Error("Network response error");return e.json()})).then((e=>{_.xAxis[0].setCategories(e[0]),_.series[0].setData(e[1]),n(".load_overlay")})).catch((function(e){console.log(e)})))})),r(".discount_price_test","click",(function(){let e=new s;e.mandatories=["#standard_price","#test_days","#test_mileage","#days_lower_limit","#days_upper_limit","#days_max_discount","#days_coefficient","#mileage_lower_limit","#mileage_upper_limit","#mileage_max_discount","#mileage_coefficient"];let t=e.process();!1!==t&&fetch(price_discount_test_ajax_url,{method:"POST",body:t,cache:"no-cache"}).then((e=>{if(!e.ok)throw new Error("Network response error");return e.json()})).then((e=>{document.querySelector(".test_final_price span").textContent=e,n(".load_overlay")})).catch((function(e){console.log(e)}))})),r(document,"input change",".red_error",(function(e){l(e,"red_error"),l(e.closest(".js_parent").querySelector(".this_element_name"),"red_error")}));var f=".ico_drop_load";r(document.body,"drop dragover dragstart dragenter",(function(e,t){t.preventDefault()})),r(document.querySelector(f),"drop dragover dragstart dragenter",(function(e,t){t.preventDefault()}));var p={action:"drop",secondary_target:".image_preview",error_class:".ico_error",max_size:"10 MB"},y=JSON.parse(JSON.stringify(p));y.action="click",o(f,"drop",upload_one_file_with_data,p),o(".hidden_file_input","change",upload_one_file_with_data,y),r(".inliner.status","click",(function(e){c(e,"inactive")?l(e,"inactive"):i(e,"inactive")})),r(".save","click",(function(){let e=["#language_name"],t=["#language_slogan"];is_primary_language&&(e=["#language_name","#battery_capacity","#traction","#spz","#bail","#standard_price","#days_lower_limit","#days_upper_limit","#days_max_discount","#days_coefficient","#mileage_lower_limit","#mileage_upper_limit","#mileage_max_discount","#mileage_coefficient"],t=["#language_slogan","#manufacturer","#current_condition","#action_price","#bail_with_rider","#surcharge_for_rider","#vin","#color","#mileage_now","#is_performance","#use_action_price"]),document.querySelector("#use_action_price").checked&&e.push("#action_price");let r=new s;r.mandatories=e,r.optionals=t;let o=r.process();if(!1===o)return;o.append("language_description",tinymce.get("language_description").getContent()),o.append("language_status",c(".inliner.status","inactive")?"draft":"active");let i={};Array.from(document.querySelectorAll("input.tires")).forEach((function(e){i[e.id]=e.value.trim()})),o.append("tire_condition",JSON.stringify(i)),is_primary_language&&""!=file_buffer&&o.append("image",file_buffer),o.append("car_id",car_id),a(".load_overlay"),fetch(save_car_ajax_url,{method:"POST",body:o,cache:"no-cache"}).then((e=>{if(!e.ok)throw new Error(e.json());return e.redirected&&(window.location.href=e.url),e.json()})).then((e=>{""!=e?(document.querySelector(".error_is").innerHTML(e),a(".general_error")):(show_success.play(0),file_buffer=""),n(".load_overlay")})).catch((function(e){console.log(e)}))}))}"undefined"!=typeof pagetype&&"car settings"==pagetype&&(Array.from(document.querySelectorAll(".select_type")).forEach((e=>{let r=e.id,o=new vanillaSelectBox("#"+r,{maxSelect:1});o.disableItems([""]),t.put(e,"vanillaSelectBox",o)})),r(".save","click",(function(){let e={};Array.from(document.querySelectorAll("input, select")).forEach((t=>e[t.id]=t.value.trim())),a(".load_overlay"),m(e,save_car_setting_ajax_url)})))}))}();