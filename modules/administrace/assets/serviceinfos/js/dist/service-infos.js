!function(){"use strict";function e(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const t={_storage:new WeakMap,put:function(e,t,o){this._storage.has(e)||this._storage.set(e,new Map),this._storage.get(e).set(t,o)},get:function(e,t){return this._storage.get(e).get(t)},has:function(e,t){return this._storage.has(e)&&this._storage.get(e).has(t)},remove:function(e,t){var o=this._storage.get(e).delete(t);return 0===!this._storage.get(e).size&&this._storage.delete(e),o}},o=function(e,t,o,n){let r;r="object"==typeof e?[document]:Array.from(document.querySelectorAll(e));let c=t.split(" ");if("function"==typeof o){let e=o;r.forEach((function(t){c.forEach((function(o){t.addEventListener(o,(function(o){e(t,o)}))}))}))}else r.forEach((function(e){c.forEach((function(t){e.addEventListener(t,(function(e){e.target.matches(o)&&n(e.target,e)}))}))}))},n=function(e,t="block"){Array.from(document.querySelectorAll(e)).forEach((function(e){e.style.display=t}))},r=function(e){Array.from(document.querySelectorAll(e)).forEach((function(e){e.style.display="none"}))},c=function(e,t){let o;"object"==typeof e?e instanceof Element?o=[e]:e instanceof NodeList&&(o=Array.from(e)):o=Array.from(document.querySelectorAll(e)),o.forEach((function(e){e.classList.add(t)}))},i=function(e,t){let o;"object"==typeof e?e instanceof Element?o=[e]:e instanceof NodeList&&(o=Array.from(e)):o=Array.from(document.querySelectorAll(e)),o.forEach((function(e){e.classList.remove(t)}))};class a{constructor(){e(this,"mandatories",[]),e(this,"optionals",[]),e(this,"throwErrors",!0)}process(){let e=!1,o="",n=[],r=this.mandatories,c=this.optionals,i=this.throwErrors;if(r.length&&(n=Array.from(document.querySelectorAll(r)),n.forEach((function(t,n){if(t){let n=t.value;null==n&&(n=""),""==n.trim()&&(t.closest(".js_parent").querySelector(".this_element_name").classList.add("red_error"),t.classList.add("red_error"),e=!0,o+='<p>Je třeba vyplnit "'+t.closest(".js_parent").querySelector(".this_element_name").textContent+'"</p>')}})),e)){if(i){let e=document.querySelector(".general_error");e.querySelector(".error_is").innerHTML=o,e.style.display="block",TweenMax.to([document.documentElement,document.body],1,{scrollTop:l(document.querySelector(".red_error")).top})}return!1}c.length&&(n=n.concat(Array.from(document.querySelectorAll(c))));let a=new FormData;return n.forEach((function(e,o){if(e){let o=e.id,n=0;if(t.has(e,"Datepick")){let o=new Date(t.get(e,"Datepick").getDate("mm/dd/yyyy"));e.classList.contains("from")?(o.setHours(0,0,0,0),n=Math.ceil(o.getTime()/1e3)):e.classList.contains("to")?(o.setHours(23,59,59,999),n=Math.floor(o.getTime()/1e3)):(o.setHours(0,0,0,0),n=Math.ceil(o.getTime()/1e3))}else n=e.matches('[type="checkbox"]')?Number(e.checked):e.value.trim();a.append(o,n)}})),a}}const l=function(e){const t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset-document.documentElement.clientTop,left:t.left+window.pageXOffset-document.documentElement.clientLeft}};Date;class s{constructor(e){return this.formData=new FormData,this.createFormData=function(e,t=""){for(let o in e){let n=e[o],r=t?t+"["+o+"]":o;"string"==typeof n||"number"==typeof n?this.formData.append(r,n):"object"==typeof n&&this.createFormData(n,r)}},this.createFormData(e),this.formData}}document.addEventListener("DOMContentLoaded",(function(e){let l,d=1;function u(e=!1){e?d++:d=1;let t=new a;t.optionals=["#car_id","#owner","#status"];let o=t.process();o.append("page",d),n(".load_overlay"),fetch(filter_ajax_url,{method:"POST",body:o,cache:"no-cache"}).then((e=>{if(!e.ok)throw new Error("Network response error");return e.json()})).then((t=>{e?document.querySelector(".service_info_table tbody").insertAdjacentHTML("afterend",t.html):document.querySelector(".service_info_table tbody").innerHTML=t.html,t.can_load_more?n(".load_more_records","inline-block"):r(".load_more_records"),document.querySelector(".records_found span").textContent=t.count,l(),r(".load_overlay")})).catch((function(e){console.log(e)}))}function f(e,t,o=!1){n(".load_overlay");let c=new s(e);fetch(t,{method:"POST",body:c,cache:"no-cache"}).then((e=>{if(!e.ok)throw new Error("Network response error");return e.json()})).then((e=>{o?u():show_success.play(0),r(".load_overlay")})).catch((function(e){console.log(e)}))}if("undefined"!=typeof pagetype&&"service infos index"==pagetype){const e={placement:"top",html:!0,delay:{show:700,hide:0},offset:"0, 1"},a=new Map([[".admin_ico.admin_edit","Upravit záznam"],[".admin_ico.admin_delete","Smazat záznam"],[".admin_ico.admin_solved",'Vyřešeno.<br>Kliknutím změníte stav na "Zatím nevyřešeno"'],[".admin_ico.admin_unsolved",'Zatím nevyřešeno.<br>Kliknutím změníte stav na "Vyřešeno"']]);l=function(){!function(e,t){e.forEach((function(e,o){Array.from(document.querySelectorAll(o)).forEach((function(o,n){t.title=e,new Tooltip(o,t)}))}))}(a,e)},l(),Array.from(document.querySelectorAll(".select_type")).forEach((e=>{let o=e.id,n=new vanillaSelectBox("#"+o,{maxSelect:1});n.disableItems(["0"]),t.put(e,"vanillaSelectBox",n)})),u(),o(document,"click",".admin_ico.admin_delete",(function(e){document.querySelector(".car_deletion .deletion_id").value=e.dataset.id,n(".car_deletion")})),o(".deletion_cancel","click",(function(){document.querySelector(".car_deletion .deletion_id").value="",r(".car_deletion")})),o(".deletion_confirm","click",(function(){let e=document.querySelector(".car_deletion .deletion_id").value,t={id:document.querySelector(".car_deletion .deletion_id").value};document.querySelector(".car_deletion .deletion_id").value="",r(".car_deletion"),document.querySelector('tr[data-id="'+e+'"]').remove(),f(t,delete_ajax_url,!0)})),o(document,"click",".admin_ico.info_status",(function(e){let t=e.closest("tr").querySelectorAll(".status_indicator"),o=e.closest("tr").querySelector(".info_status:not(#"+e.id+")").closest(".status_indicator");i(t,"visible"),c(t,"invisible"),i(o,"invisible"),c(o,"visible"),f({id:e.dataset.id,status:e.id},status_ajax_url)})),o(".reset_filters","click",(function(){Array.from(document.querySelectorAll(".select_type")).forEach((function(e){t.get(e,"vanillaSelectBox").setValue("0")})),u()})),o("select.select_type","change",(function(){u()})),o(".load_more_records","click",(function(){u(!0)}))}"undefined"==typeof pagetype||"service info new"!=pagetype&&"service info edit"!=pagetype||(Array.from(document.querySelectorAll(".select_type")).forEach((e=>{let o=e.id,n=new vanillaSelectBox("#"+o,{maxSelect:1});n.disableItems(["0"]),t.put(e,"vanillaSelectBox",n)})),Array.from(document.querySelectorAll(".only_digits_limited")).forEach((e=>{IMask(e,{mask:Number,scale:0,signed:!1,thousandsSeparator:""})})),init_text_editor("#description","undo redo | bold italic underline strikethrough subscript superscript removeformat numlist bullist"),o(".save","click",(function(){let e=new a;e.mandatories=["#title"],e.optionals=["#car_id","#owner","#status","#amount"];let t=e.process();!1!==t&&(t.append("description",tinymce.get("description").getContent()),t.append("info_id",info_id),n(".load_overlay"),fetch(save_info_ajax_url,{method:"POST",body:t,cache:"no-cache"}).then((e=>{if(!e.ok)throw new Error(e.json());return e.redirected&&(window.location.href=e.url),e.json()})).then((e=>{r(".load_overlay"),show_success.play(0)})).catch((function(e){console.log(e)})))})))}))}();